name: Build gRPC Mac
agent:
  type: Unity::VM::osx
  image: desktop/unity-macos-10.15-xcode-12.2:stable
  flavor: b1.medium
commands:
  - |
    HOMEBREW_NO_AUTO_UPDATE=1 brew install autoconf libtool go
    brew install --cask cmake
    ./dotnet-install.sh --version 5.0.201
    git submodule update --init
    ./unity/build_grpc_mac_linux.sh mac arm64 x86_64
    ./unity/build_grpc_mac_linux.sh win
artifacts:
  libraries:
    paths:
      - "artifacts/**"
